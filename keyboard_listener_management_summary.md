# Keyboard Listener Management Summary

## ğŸ” **ä¿®å¤çš„é—®é¢˜**

### 1. **é‡å¤åœæ­¢listeneré—®é¢˜**
- **ä¿®å¤å‰**: `main_human_decide`å·²ç»åœæ­¢listenerï¼Œä½†å­æ–¹æ³•åˆé‡å¤åœæ­¢
- **ä¿®å¤å**: å­æ–¹æ³•ä¸­ç§»é™¤é‡å¤çš„`stop_keyboard_listener()`è°ƒç”¨ï¼Œåªåœ¨`main_human_decide`ä¸­åœæ­¢ä¸€æ¬¡

### 2. **listeneræœªé‡å¯é—®é¢˜**  
- **ä¿®å¤å‰**: å¾ˆå¤šæ–¹æ³•ä½¿ç”¨`input()`åæ²¡æœ‰é‡å¯listener
- **ä¿®å¤å**: åœ¨é€‚å½“çš„æ—¶æœºé‡æ–°å¯åŠ¨listener

### 3. **é€’å½’è°ƒç”¨é—®é¢˜**
- **ä¿®å¤å‰**: `handle_playback_traj`é€’å½’è°ƒç”¨`main_human_decide`å¯¼è‡´çŠ¶æ€æ··ä¹±
- **ä¿®å¤å**: ç§»é™¤é€’å½’è°ƒç”¨ï¼Œç›´æ¥è¿”å›è®©ä¸Šå±‚å¤„ç†

## ğŸ”„ **æ­£ç¡®çš„å·¥ä½œæµç¨‹**

### **äººå·¥å†³ç­–æµç¨‹**:
```
human_decide_process() 
â”œâ”€â”€ teleop_state = "busy"
â”œâ”€â”€ main_human_decide()
â”‚   â”œâ”€â”€ stop_keyboard_listener()  â† åœ¨è¿™é‡Œåœæ­¢ä¸€æ¬¡
â”‚   â”œâ”€â”€ input() è·å–ç”¨æˆ·å†³ç­–
â”‚   â”œâ”€â”€ è°ƒç”¨å¯¹åº”çš„handle_xxx()æ–¹æ³•
â”‚   â””â”€â”€ æ ¹æ®å†³ç­–ç±»å‹é‡å¯listener
â””â”€â”€ teleop_stateç®¡ç†
```

### **åœºæ™¯å¯¹é½æµç¨‹**:
```
handle_scene_alignment_request()
â”œâ”€â”€ teleop_state = "busy" 
â”œâ”€â”€ stop_keyboard_listener()  â† ç‹¬ç«‹åœæ­¢
â”œâ”€â”€ perform_scene_alignment_xxx()
â”‚   â””â”€â”€ input() (ä¸é‡å¤åœæ­¢listener)
â”œâ”€â”€ å‘é€å®Œæˆæ¶ˆæ¯
â”œâ”€â”€ teleop_state = "idle"
â””â”€â”€ start_keyboard_listener()  â† é‡æ–°å¯åŠ¨
```

### **é¥æ“ä½œæµç¨‹**:
```
handle_need_teleop()
â”œâ”€â”€ input() ç¡®è®¤å¼€å§‹
â”œâ”€â”€ å‘é€rewindæ¶ˆæ¯
â””â”€â”€ teleop_ctrl_start()
    â”œâ”€â”€ start_keyboard_listener()  â† ä¸ºé¥æ“ä½œå¯åŠ¨
    â””â”€â”€ run_listen_loop()
        â””â”€â”€ stop_keyboard_listener()  â† é¥æ“ä½œç»“æŸæ—¶åœæ­¢
```

## âœ… **å…³é”®ä¿®å¤ç‚¹**

1. **é¿å…é‡å¤åœæ­¢**: å­æ–¹æ³•ä¸å†é‡å¤è°ƒç”¨`stop_keyboard_listener()`
2. **æ™ºèƒ½é‡å¯**: `main_human_decide`æ ¹æ®å†³ç­–ç±»å‹('N'é™¤å¤–)é‡å¯listener
3. **çŠ¶æ€ç®¡ç†**: ç¡®ä¿`teleop_state`å’ŒlistenerçŠ¶æ€åŒæ­¥
4. **çº¿ç¨‹å®‰å…¨**: åœºæ™¯å¯¹é½åœ¨ç‹¬ç«‹çº¿ç¨‹ä¸­æ­£ç¡®ç®¡ç†listener
5. **æ—¶æœºæ§åˆ¶**: ç»™æ“ä½œå®Œæˆç•™å‡ºæ—¶é—´ï¼ˆ`time.sleep(0.1)`ï¼‰

## ğŸ¯ **æœ€ç»ˆæ•ˆæœ**

- âœ… **æ— å†²çª**: `input()`å’Œ`keyboard_listener`ä¸å†å†²çª
- âœ… **è‡ªåŠ¨ç®¡ç†**: listeneråœ¨æ­£ç¡®æ—¶æœºè‡ªåŠ¨å¯åœ
- âœ… **çŠ¶æ€ä¸€è‡´**: é¥æ“ä½œçŠ¶æ€å’ŒlistenerçŠ¶æ€ä¿æŒåŒæ­¥
- âœ… **æ¶æ„æ¸…æ™°**: ä¸åŒæ“ä½œæœ‰æ˜ç¡®çš„listenerç®¡ç†è´£ä»» 